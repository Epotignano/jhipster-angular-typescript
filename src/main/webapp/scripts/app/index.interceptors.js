/// <reference path="commons/subscriptions.service.ts" />
/// <reference path="../../typings/tsd.d.ts" />
var Onesnap;
(function (Onesnap) {
    var RXInterceptor = (function () {
        function RXInterceptor(StreamsService) {
            this.StreamsService = StreamsService;
            return;
        }
        RXInterceptor.prototype.response = function (response) {
            console.log(response);
            if ((response.status === 200 || response.status === 201) && typeof response.data !== 'string') {
                var _stream = this.StreamsService.getStream(response.config.url);
                if (!_stream) {
                    this.StreamsService.setStream(response.config.url, new Rx.Subject());
                    _stream = this.StreamsService.getStream(response.config.url);
                }
                _stream.onNext({ type: response.statusText, data: response.data });
            }
            return response;
        };
        return RXInterceptor;
    })();
    Onesnap.RXInterceptor = RXInterceptor;
    function getInstance(StreamsService) {
        return new RXInterceptor(StreamsService);
    }
    Onesnap.getInstance = getInstance;
    angular.module('springTestApp').factory('rxInterceptorFactory', getInstance);
})(Onesnap || (Onesnap = {}));

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmludGVyY2VwdG9ycy50cyJdLCJuYW1lcyI6WyJPbmVzbmFwIiwiT25lc25hcC5SWEludGVyY2VwdG9yIiwiT25lc25hcC5SWEludGVyY2VwdG9yLmNvbnN0cnVjdG9yIiwiT25lc25hcC5SWEludGVyY2VwdG9yLnJlc3BvbnNlIiwiT25lc25hcC5nZXRJbnN0YW5jZSJdLCJtYXBwaW5ncyI6IkFBQUEseURBQXlEO0FBQ3pELCtDQUErQztBQUUvQyxJQUFPLE9BQU8sQ0E4QmI7QUE5QkQsV0FBTyxPQUFPLEVBQUMsQ0FBQztJQUVmQSxJQUFhQSxhQUFhQTtRQUN6QkMsU0FEWUEsYUFBYUEsQ0FDTEEsY0FBc0NBO1lBQXRDQyxtQkFBY0EsR0FBZEEsY0FBY0EsQ0FBd0JBO1lBQ3pEQSxNQUFNQSxDQUFDQTtRQUNSQSxDQUFDQTtRQUNERCxnQ0FBUUEsR0FBUkEsVUFBU0EsUUFBUUE7WUFDaEJFLE9BQU9BLENBQUNBLEdBQUdBLENBQUNBLFFBQVFBLENBQUNBLENBQUNBO1lBQ3RCQSxFQUFFQSxDQUFDQSxDQUFFQSxDQUFDQSxRQUFRQSxDQUFDQSxNQUFNQSxLQUFLQSxHQUFHQSxJQUFJQSxRQUFRQSxDQUFDQSxNQUFNQSxLQUFLQSxHQUFHQSxDQUFDQSxJQUFJQSxPQUFPQSxRQUFRQSxDQUFDQSxJQUFJQSxLQUFLQSxRQUFRQSxDQUFDQSxDQUFDQSxDQUFDQTtnQkFDaEdBLElBQUlBLE9BQU9BLEdBQUdBLElBQUlBLENBQUNBLGNBQWNBLENBQUNBLFNBQVNBLENBQUNBLFFBQVFBLENBQUNBLE1BQU1BLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO2dCQUNqRUEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsT0FBT0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7b0JBQ2RBLElBQUlBLENBQUNBLGNBQWNBLENBQUNBLFNBQVNBLENBQUNBLFFBQVFBLENBQUNBLE1BQU1BLENBQUNBLEdBQUdBLEVBQUVBLElBQUlBLEVBQUVBLENBQUNBLE9BQU9BLEVBQU1BLENBQUNBLENBQUFBO29CQUN4RUEsT0FBT0EsR0FBR0EsSUFBSUEsQ0FBQ0EsY0FBY0EsQ0FBQ0EsU0FBU0EsQ0FBQ0EsUUFBUUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQUE7Z0JBQzdEQSxDQUFDQTtnQkFDREEsT0FBT0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsRUFBQ0EsSUFBSUEsRUFBRUEsUUFBUUEsQ0FBQ0EsVUFBVUEsRUFBRUEsSUFBSUEsRUFBRUEsUUFBUUEsQ0FBQ0EsSUFBSUEsRUFBQ0EsQ0FBQ0EsQ0FBQUE7WUFDakVBLENBQUNBO1lBRURBLE1BQU1BLENBQUNBLFFBQVFBLENBQUFBO1FBQ2hCQSxDQUFDQTtRQUNGRixvQkFBQ0E7SUFBREEsQ0FqQkFELEFBaUJDQyxJQUFBRDtJQWpCWUEscUJBQWFBLEdBQWJBLGFBaUJaQSxDQUFBQTtJQUdEQSxTQUFnQkEsV0FBV0EsQ0FBQ0EsY0FBc0NBO1FBQ2pFSSxNQUFNQSxDQUFDQSxJQUFJQSxhQUFhQSxDQUFDQSxjQUFjQSxDQUFDQSxDQUFBQTtJQUN6Q0EsQ0FBQ0E7SUFGZUosbUJBQVdBLEdBQVhBLFdBRWZBLENBQUFBO0lBR0RBLE9BQU9BLENBQUNBLE1BQU1BLENBQUNBLGVBQWVBLENBQUNBLENBQzdCQSxPQUFPQSxDQUFDQSxzQkFBc0JBLEVBQUVBLFdBQVdBLENBQUNBLENBQUNBO0FBRWhEQSxDQUFDQSxFQTlCTSxPQUFPLEtBQVAsT0FBTyxRQThCYiIsImZpbGUiOiJpbmRleC5pbnRlcmNlcHRvcnMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiY29tbW9ucy9zdWJzY3JpcHRpb25zLnNlcnZpY2UudHNcIiAvPlxyXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vdHlwaW5ncy90c2QuZC50c1wiIC8+XHJcblxyXG5tb2R1bGUgT25lc25hcCB7XHJcblxyXG5cdGV4cG9ydCBjbGFzcyBSWEludGVyY2VwdG9yIHtcclxuXHRcdGNvbnN0cnVjdG9yKHByaXZhdGUgU3RyZWFtc1NlcnZpY2U6IE9uZXNuYXAuU3RyZWFtc1NlcnZpY2UpIHtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cdFx0cmVzcG9uc2UocmVzcG9uc2UpIHtcclxuXHRcdFx0Y29uc29sZS5sb2cocmVzcG9uc2UpO1xyXG5cdFx0XHRpZiAoIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCB8fCByZXNwb25zZS5zdGF0dXMgPT09IDIwMSkgJiYgdHlwZW9mIHJlc3BvbnNlLmRhdGEgIT09ICdzdHJpbmcnKSB7XHJcblx0XHRcdFx0dmFyIF9zdHJlYW0gPSB0aGlzLlN0cmVhbXNTZXJ2aWNlLmdldFN0cmVhbShyZXNwb25zZS5jb25maWcudXJsKTtcclxuXHRcdFx0XHRpZiAoIV9zdHJlYW0pIHtcclxuXHRcdFx0XHRcdHRoaXMuU3RyZWFtc1NlcnZpY2Uuc2V0U3RyZWFtKHJlc3BvbnNlLmNvbmZpZy51cmwsIG5ldyBSeC5TdWJqZWN0PHt9PigpKVxyXG5cdFx0XHRcdFx0X3N0cmVhbSA9IHRoaXMuU3RyZWFtc1NlcnZpY2UuZ2V0U3RyZWFtKHJlc3BvbnNlLmNvbmZpZy51cmwpXHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdF9zdHJlYW0ub25OZXh0KHt0eXBlOiByZXNwb25zZS5zdGF0dXNUZXh0LCBkYXRhOiByZXNwb25zZS5kYXRhfSlcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0cmV0dXJuIHJlc3BvbnNlXHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHJcblx0ZXhwb3J0IGZ1bmN0aW9uIGdldEluc3RhbmNlKFN0cmVhbXNTZXJ2aWNlOiBPbmVzbmFwLlN0cmVhbXNTZXJ2aWNlKSB7XHJcblx0XHRyZXR1cm4gbmV3IFJYSW50ZXJjZXB0b3IoU3RyZWFtc1NlcnZpY2UpXHJcblx0fVxyXG5cclxuXHJcblx0YW5ndWxhci5tb2R1bGUoJ3NwcmluZ1Rlc3RBcHAnKVxyXG5cdFx0LmZhY3RvcnkoJ3J4SW50ZXJjZXB0b3JGYWN0b3J5JywgZ2V0SW5zdGFuY2UpO1xyXG5cclxufSJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==